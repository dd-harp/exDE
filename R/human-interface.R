# generic methods for human component

#' @title Size of effective infectious human population
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param t current simulation time
#' @param y state vector
#' @param pars a list
#' @return a [numeric] vector of length `nStrata`
#' @export
F_X <- function(t, y, pars) {
  UseMethod("F_X", pars$Xpar)
}

#' @title Size of human population denominators
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param t current simulation time
#' @param y state vector
#' @param pars a list
#' @return a [numeric] vector of length `nStrata`
#' @export
F_H <- function(t, y, pars) {
  UseMethod("F_H", pars$Xpar)
}

#' @title Compute the "true" prevalence of infection / parasite rate
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param varslist a list with variables attached by name
#' @param pars a list
#' @return a [numeric] vector of length `nStrata`
#' @export
F_pr <- function(varslist, pars) {
  UseMethod("F_pr", pars$Xpar)
}

#' @title Infection blocking pre-erythrocytic immunity
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param y state vector
#' @param pars a list
#' @return a [numeric] vector of length `nStrata`
#' @export
F_b <- function(y, pars) {
  UseMethod("F_b", pars$Xpar)
}

#' @title Derivatives for human population
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param t current simulation time
#' @param y state vector
#' @param pars a list
#' @param FoI vector giving the per-capita force of infection for each strata
#' @return a [numeric] vector
#' @export
dXdt <- function(t, y, pars, FoI) {
  UseMethod("dXdt", pars$Xpar)
}

#' @title A function to set up Xpar
#' @description This method dispatches on `Xname`.
#' @param pars a [list]
#' @param Xname a [character] string
#' @param Xopts a [list]
#' @return a [list]
#' @export
setup_X = function(pars, Xname, Xopts=list()){
  class(Xname) <- Xname
  UseMethod("setup_X", Xname)
}

#' @title Add indices for human population to parameter list
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param pars a [list]
#' @return a [list]
#' @export
make_indices_X <- function(pars) {
  UseMethod("make_indices_X", pars$Xpar)
}

#' @title Parse the output of deSolve and return the variables by name in a list
#' @description This method dispatches on the type of `pars$Xpar`. Adds the variables
#' from the X model to a list and returns it
#' @param deout a [matrix] of outputs from deSolve
#' @param pars a [list] that defines a model
#' @export
parse_deout_X <- function(deout, pars) {
  UseMethod("parse_deout_X", pars$Xpar)
}

#' @title Return initial values as a vector
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param pars a [list]
#' @return none
#' @export
get_inits_X <- function(pars) {
  UseMethod("get_inits_X", pars$Xpar)
}

#' @title Set the initial values from a vector of states
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param pars a [list]
#' @param y0 a vector of initial values
#' @return none
#' @export
update_inits_X <- function(pars, y0) {
  UseMethod("update_inits_X", pars$Xpar)
}

#' @title Compute the human transmitting capacity
#' @description This method dispatches on the type of `pars$Xpar`.
#' @param pars a [list]
#' @return none
#' @export
HTC <- function(pars) {
  UseMethod("get_inits_X", pars$Xpar)
}

#' Basic plotting for epidemiological models
#'
#' @param pars a list that defines an `exDE` model (*e.g.*,  generated by `xde_setup()`)
#' @param clrs a vector of colors
#' @param llty an integer (or integers) to set the `lty` for plotting
#' @param stable a logical: set to FALSE for `orbits` and TRUE for `stable_orbits`
#' @param add_axes a logical: plot axes only if TRUE
#'
#' @export
xde_plot_X = function(pars, clrs="black", llty=1, stable=FALSE, add_axes=TRUE){
  UseMethod("xde_plot_X", pars$Xpar)
}

#' Add lines for basic outputs of epidemiological models
#'
#' @param XH a list with the outputs of `exDE::parse_deout()`
#' @param pars a list that defines an `exDE` model (*e.g.*,  generated by `xde_setup()`)
#' @param clrs a vector of colors
#' @param llty an integer (or integers) to set the `lty` for plotting
#'
#' @export
xde_lines_X = function(XH, pars, clrs="black", llty=1){
  UseMethod("xde_lines_X", pars$Xpar)
}

